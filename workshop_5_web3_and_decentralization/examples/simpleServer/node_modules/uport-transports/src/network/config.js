import { NETWORK, networks } from './defaults.js'

const network = (net = NETWORK) => {
  if (typeof net === 'object') {
    ;['id', 'rpcUrl'].forEach(key => {
      if (!net.hasOwnProperty(key))
        throw new Error(`Malformed network config object, object must have '${key}' key specified.`)
    })
    return net
  } else if (typeof net === 'string') {
    if (!networks[net]) throw new Error(`Network configuration not available for '${net}'`)
    return networks[net]
  }

  throw new Error(`Network configuration object or network string required`)
}

const networkSet = nets => {
  Object.keys(nets).forEach(key => {
    const net = nets[key]
    if (typeof net === 'object') {
      if (!net.rpcUrl)
        throw new Error(`Malformed network config object, object must have 'rpcUrl' key specified.`)
    } else {
      throw new Error(`Network configuration object required`)
    }
  })
  return nets
}

const networkToNetworkSet = net => ({ [net.id]: { registry: net.registry, rpcUrl: net.rpcUrl } })

export { network, networkSet, networkToNetworkSet }
